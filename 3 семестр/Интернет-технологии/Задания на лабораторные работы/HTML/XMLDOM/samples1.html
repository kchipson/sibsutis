<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Sample</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<link REL="stylesheet" TYPE="text/css" HREF="mstyle.css">
<script language="JavaScript" >
 function LoadDoc()
 {  var xmldoc=new ActiveXObject("Microsoft.XMLDOM");  
        xmldoc.async=false;
        xmldoc.load("samples.xml"); // загружаем документ в память
    output=" Овощи : \n";
    // требуется извлечь из документа - список всех овощей
    // т.е. продукты, заключены в тег <product> </product> элемента <vegetables></vegetables>
   
   nodes=xmldoc.documentElement.childNodes; //получаем все дочерние узлы корневого узла
   for(i=0;i<nodes.length;i++)
   { eL=nodes.item(i); // получаем i element списка
     if(eL.nodeName=="vegetables") // находим овощи
     { child=eL.childNodes; // получаем все дочерние элементы
       break;
     } 
   }
  
    eL=child.item(0); // так как дочерних елементов может быть несколько, то неоходимо обратиться к тому, который требуется 
   
   while(true)
   { 
     if (eL.nodeName=="product") output+=eL.text+" "; 
     eL=eL.nextSibling; // получаем следующий дочерний узел 
     if(!eL) break; 
   } 
 
   document.all.textar.value=output;    
 } 
</script>

</head>
<body onLoad="LoadDoc()">
<h3>Работа кода по извлечению значений:</h3>
<hr color=black>
 
 Результат извлечения значения узлa &lt;product&gt;, элемента vegetables :
 <br>
 <br> 
 <textarea name="textar" rows=10 cols=40> </textarea> 
     
</body>
</html>







